# Change Log: Version 1.21.0

**Release Date:** 2026-01-06

This release introduces significant new features for exporting email data and includes major internal refactoring to improve code maintainability and scalability.

## New Features

### Email Export to JSON
-   **`exportinbox` Action:** Added a new action (`-action exportinbox`) to export email messages from the user's Inbox to individual JSON files.
    -   The `-count` flag can be used to specify the number of messages to export.
-   **`searchandexport` Action:** Added a new action (`-action searchandexport`) to find a specific email by its Internet Message ID and export it to a JSON file.
    -   This action uses the new `-messageid` flag.
-   **Automated Directory Creation:** Exported files are automatically saved to a date-stamped directory for easy organization (e.g., `%TEMP%\export\2026-01-06`).

## Code Refactoring & Improvements

-   **Modularization:** The monolithic `src/shared.go` file has been completely refactored and split into multiple, single-responsibility files (`auth.go`, `config.go`, `handlers.go`, `logger.go`, `utils.go`), significantly improving code organization and maintainability.
-   **Unit Testing:** Added new unit tests to cover the new export functionality, including configuration validation and helper functions.
-   **Code Quality:** Fixed a bug in `sanitizeFilename` to correctly handle special characters common in Graph API IDs.

## Minor Changes

-   Updated Bash and PowerShell completion scripts to include the new actions and flags.
-   Enhanced verbose logging for the new actions.
